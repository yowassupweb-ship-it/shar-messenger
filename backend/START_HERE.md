# üöÄ –ù–ê–ß–ù–ò –û–¢–°–Æ–î–ê - –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ PostgreSQL –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö

–≠—Ç–æ —Å–∞–º—ã–π –∫–æ—Ä–æ—Ç–∫–∏–π –∏ –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ PostgreSQL.

---

## ‚ö° –ó–∞ 5 –º–∏–Ω—É—Ç (–ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–±)

### 1Ô∏è‚É£ –û—Ç–∫—Ä–æ–π —Ç–µ—Ä–º–∏–Ω–∞–ª –∏ –ø–µ—Ä–µ–π–¥–∏ –≤ –ø–∞–ø–∫—É:
```bash
cd vs-tools/backend
```

### 2Ô∏è‚É£ –ó–∞–ø—É—Å—Ç–∏ —Å–∫—Ä–∏–ø—Ç:
```bash
# –î–ª—è Linux/Mac
bash quick_migrate.sh

# –î–ª—è Windows (PowerShell)
python db_switch.py migrate
```

### 3Ô∏è‚É£ –û—Ç–≤–µ—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã:
- –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ PostgreSQL? **y** (yes)

### 4Ô∏è‚É£ –ì–æ—Ç–æ–≤–æ! üéâ

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç PostgreSQL –≤–º–µ—Å—Ç–æ JSON.

---

## üîç –ï—Å–ª–∏ —É —Ç–µ–±—è –µ—Å—Ç—å –≤—Ä–µ–º—è (15 –º–∏–Ω—É—Ç)

### –°–ø–æ—Å–æ–± 1: –° Docker (—Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π)

**–®–∞–≥ 1:** –ó–∞–ø—É—Å—Ç–∏ PostgreSQL
```bash
cd vs-tools/backend
docker-compose up -d
```

**–®–∞–≥ 2:** –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
```bash
python db_switch.py status
```

**–®–∞–≥ 3:** –ü–µ—Ä–µ–Ω–µ—Å–∏ –¥–∞–Ω–Ω—ã–µ
```bash
python db_switch.py migrate
```

**–®–∞–≥ 4:** –ü–µ—Ä–µ–∫–ª—é—á–∏—Å—å –Ω–∞ PostgreSQL
```bash
python db_switch.py to-postgres
```

**–®–∞–≥ 5:** –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏ —Å—Ç–∞—Ä–æ–µ
pkill -f "uvicorn main:app"

# –ó–∞–ø—É—Å—Ç–∏ –Ω–æ–≤–æ–µ
python main.py
```

---

### –°–ø–æ—Å–æ–± 2: –ë–µ–∑ Docker (—Ç—Ä–µ–±—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ PostgreSQL)

**–®–∞–≥ 1:** –£—Å—Ç–∞–Ω–æ–≤–∏ PostgreSQL
```bash
# Ubuntu/Debian
sudo apt install postgresql

# macOS
brew install postgresql

# Windows
# –°–∫–∞—á–∞–π —Å https://www.postgresql.org/download/windows/
```

**–®–∞–≥ 2:** –°–æ–∑–¥–∞–π –ë–î
```bash
sudo -u postgres psql << 'EOF'
CREATE DATABASE shar_messenger;
CREATE USER shar_user WITH PASSWORD 'password123';
GRANT ALL PRIVILEGES ON DATABASE shar_messenger TO shar_user;
EOF
```

**–®–∞–≥ 3:** –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π —Å—Ö–µ–º—É –ë–î
```bash
cd vs-tools/backend
psql -h localhost -U shar_user -d shar_messenger < schema.sql
```

**–®–∞–≥ 4-5:** –ü–æ–≤—Ç–æ—Ä–∏ –®–∞–≥ 3-5 –∏–∑ –°–ø–æ—Å–æ–±–∞ 1

---

## üìö –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ –ø–æ–Ω–∏–º–∞–µ—à—å

### –ß—Ç–æ —Ç–∞–∫–æ–µ PostgreSQL?
–≠—Ç–æ –Ω–∞–¥—ë–∂–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≤–º–µ—Å—Ç–æ JSON —Ñ–∞–π–ª–∞. –†–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–µ–µ, –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ, –∏ –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã.

### –ü–æ—á–µ–º—É –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å?
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–µ–µ
- ‚úÖ –î–∞–Ω–Ω—ã–µ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ
- ‚úÖ –ú–æ–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å
- ‚úÖ –ï—Å—Ç—å –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏

### –ü–æ—Ç–µ—Ä—è—é –ª–∏ —è –¥–∞–Ω–Ω—ã–µ?
**–ù–µ—Ç!** –°–∫—Ä–∏–ø—Ç –ø–µ—Ä–µ–Ω–µ—Å—ë—Ç –í–°–ï –¥–∞–Ω–Ω—ã–µ –∏–∑ database.json –≤ PostgreSQL.
–ò—Å—Ö–æ–¥–Ω—ã–π JSON –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –∫–∞–∫ —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è.

### –ö–∞–∫ –æ—Ç–∫–∞—Ç–∏—Ç—å—Å—è –Ω–∞–∑–∞–¥?
```bash
python db_switch.py to-json
# –ò –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
```

---

## üÜò –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### "–û—à–∏–±–∫–∞: psycopg2 not found"
```bash
pip install psycopg2-binary
```

### "–û—à–∏–±–∫–∞: PostgreSQL –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è"
```bash
# –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ Docker —Ä–∞–±–æ—Ç–∞–µ—Ç
docker ps

# –ò–ª–∏ —á—Ç–æ PostgreSQL —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –∑–∞–ø—É—â–µ–Ω
sudo systemctl status postgresql
```

### "–û—à–∏–±–∫–∞: –ø–æ—Ä—Ç 5432 —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è"
```bash
# –£–¥–∞–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏ –∑–∞–ø—É—Å—Ç–∏ —Å–Ω–æ–≤–∞
docker-compose down -v
docker-compose up -d
```

### "–ú–∏–≥—Ä–∞—Ü–∏—è –Ω–µ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç –¥–∞–Ω–Ω—ã–µ"
- –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ database.json –Ω–µ –ø—É—Å—Ç–æ–π
- –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω
- –ü—Ä–æ—á–∏—Ç–∞–π —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –≤ –ª–æ–≥–∞—Ö

---

## üìñ –î–ª—è –±–æ–ª–µ–µ –≥–ª—É–±–æ–∫–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è

**–ï—Å–ª–∏ –Ω—É–∂–Ω—ã –ø–æ–ª–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:**
- –ü—Ä–æ—á–∏—Ç–∞–π [POSTGRES_QUICKSTART.md](./POSTGRES_QUICKSTART.md)
- –ò–ª–∏ [MIGRATION_GUIDE.md](./MIGRATION_GUIDE.md) –¥–ª—è –≤—Å–µ—Ö –¥–µ—Ç–∞–ª–µ–π

**–ï—Å–ª–∏ –º–∏–≥—Ä–∏—Ä—É–µ—à—å –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω:**
- –ü—Ä–æ—á–∏—Ç–∞–π [SERVER_MIGRATION_STEPS.md](./SERVER_MIGRATION_STEPS.md)

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç

–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º:
- [ ] –ï—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ç–µ—Ä–º–∏–Ω–∞–ª—É
- [ ] Python —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (`python --version`)

–í–æ –≤—Ä–µ–º—è –º–∏–≥—Ä–∞—Ü–∏–∏:
- [ ] PostgreSQL –∑–∞–ø—É—â–µ–Ω
- [ ] –ú–∏–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] API —Ä–∞–±–æ—Ç–∞–µ—Ç (`curl http://localhost:8000/api/users`)

–ü–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏:
- [ ] –í–∏–¥–Ω—ã –≤—Å–µ —á–∞—Ç—ã –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
- [ ] –í–∏–¥–Ω—ã –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- [ ] –ú–æ–∂–µ—à—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- [ ] –õ–æ–≥–∏ —á–∏—Å—Ç—ã–µ (–±–µ–∑ ERROR)

---

## üéØ –¢–µ–±–µ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å —Ç–æ–ª—å–∫–æ 3 –∫–æ–º–∞–Ω–¥—ã

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
python db_switch.py status

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
python db_switch.py migrate

# 3. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ PostgreSQL
python db_switch.py to-postgres
```

---

## üí° –°–æ–≤–µ—Ç—ã

1. **–°–Ω–∞—á–∞–ª–∞ –ø–æ–ø—Ä–æ–±—É–π –ª–æ–∫–∞–ª—å–Ω–æ** (–Ω–∞ —Å–≤–æ–µ–π –º–∞—à–∏–Ω–µ)
2. **–ü–æ—Ç–æ–º –∫–æ–ø–∏—Ä—É–π –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω** (–µ—Å–ª–∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç)
3. **–î–µ—Ä–∂–∏ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é** (–Ω–∞ —Å–ª—É—á–∞–π –µ—Å–ª–∏ —á—Ç–æ)
4. **–ß–∏—Ç–∞–π –ª–æ–≥–∏** –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## üöÄ –ù–∞—á–∏–Ω–∞–µ–º!

**–í–∞—Ä–∏–∞–Ω—Ç 1 (–°—É–ø–µ—Ä–±—ã—Å—Ç—Ä–æ - 3 –º–∏–Ω—É—Ç—ã):**
```bash
cd vs-tools/backend
bash quick_migrate.sh
```

**–í–∞—Ä–∏–∞–Ω—Ç 2 (–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ - 15 –º–∏–Ω—É—Ç):**
```bash
cd vs-tools/backend
docker-compose up -d
python db_switch.py migrate
python db_switch.py to-postgres
pkill -f "uvicorn main:app"
python main.py
```

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ:
- –í—Å–µ —Ç–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ PostgreSQL
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–µ–µ
- –¢—ã –º–æ–∂–µ—à—å —Å–ø–∞—Ç—å —Å–ø–æ–∫–æ–π–Ω–æ üò¥

**–í–æ–ø—Ä–æ—Å—ã?** –ü—Ä–æ—á–∏—Ç–∞–π —Ñ–∞–π–ª—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏.

**–£–¥–∞—á–∏!** üöÄ
