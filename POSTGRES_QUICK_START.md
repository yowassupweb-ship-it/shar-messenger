# üéØ –ï–î–ò–ù–ê–Ø –ë–ê–ó–ê –î–ê–ù–ù–´–• POSTGRESQL - –ì–û–¢–û–í–û!

## ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

**–í—ã —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –µ–¥–∏–Ω—É—é PostgreSQL –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤–º–µ—Å—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ JSON —Ñ–∞–π–ª–æ–≤!**

### –ú–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ:
- ‚úÖ 20 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ 1 —Å–æ–±—ã—Ç–∏–µ  
- ‚úÖ 4 —Å—Å—ã–ª–∫–∏
- ‚úÖ 49 –∑–∞–¥–∞—á
- ‚úÖ –í—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–æ–¥—É–∫—Ç—ã

### –ë–æ–ª—å—à–µ –Ω–∏–∫–∞–∫–∏—Ö:
- ‚ùå –ü–æ—Ç–µ—Ä—å –¥–∞–Ω–Ω—ã—Ö –∏–∑-–∑–∞ JSON
- ‚ùå –ü—Ä–æ–±–ª–µ–º —Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π —Ñ–∞–π–ª–æ–≤
- ‚ùå –†—É—á–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è JSON
- ‚ùå –ö–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –ø—Ä–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –¥–æ—Å—Ç—É–ø–µ

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### 1. –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)

–í–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –£–ñ–ï —Ä–∞–±–æ—Ç–∞–µ—Ç —Å PostgreSQL!

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
cd backend
python test_postgres.py

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
python main.py
```

### 2. –î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä

#### –í–∞—Ä–∏–∞–Ω—Ç A: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)
```powershell
# –ü–æ–ª–Ω—ã–π –¥–µ–ø–ª–æ–π PostgreSQL –Ω–∞ —Å–µ—Ä–≤–µ—Ä
.\deploy-postgres.ps1

# –ò–ª–∏ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É, –µ—Å–ª–∏ PostgreSQL —É–∂–µ –µ—Å—Ç—å
.\deploy-postgres.ps1 -SkipInstall
```

#### –í–∞—Ä–∏–∞–Ω—Ç B: –†—É—á–Ω–æ–π
–°–º. –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –≤ —Ñ–∞–π–ª–µ [POSTGRESQL_MIGRATION_COMPLETE.md](POSTGRESQL_MIGRATION_COMPLETE.md)

### 3. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

#### –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä:
```powershell
.\sync-postgres.ps1 -Direction ToServer
```

#### –°–∫–∞—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —Å —Å–µ—Ä–≤–µ—Ä–∞:
```powershell
.\sync-postgres.ps1 -Direction FromServer
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```
shar_messenger (PostgreSQL)
‚îú‚îÄ‚îÄ users              # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã
‚îú‚îÄ‚îÄ events             # –ö–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
‚îú‚îÄ‚îÄ links              # –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Å—Å—ã–ª–∫–∏
‚îú‚îÄ‚îÄ tasks              # –ó–∞–¥–∞—á–∏ –∏ todo
‚îú‚îÄ‚îÄ data_sources       # –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞
‚îú‚îÄ‚îÄ products           # –¢—É—Ä—ã –∏ –ø—Ä–æ–¥—É–∫—Ç—ã
‚îú‚îÄ‚îÄ feeds              # YML —Ñ–∏–¥—ã
‚îú‚îÄ‚îÄ chats              # –ß–∞—Ç—ã –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞
‚îú‚îÄ‚îÄ messages           # –°–æ–æ–±—â–µ–Ω–∏—è
‚îú‚îÄ‚îÄ templates          # –®–∞–±–ª–æ–Ω—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞
‚îú‚îÄ‚îÄ analytics          # –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
‚îî‚îÄ‚îÄ ... (20 —Ç–∞–±–ª–∏—Ü –≤—Å–µ–≥–æ)
```

## üîß –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –†–∞–±–æ—Ç–∞ —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î:
```powershell
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ë–î
psql -h localhost -U postgres -d shar_messenger

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–∞–±–ª–∏—Ü—ã
\dt

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
SELECT id, name, username, role FROM users;

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–¥–∞—á–∏
SELECT id, title, status FROM tasks LIMIT 10;

# –í—ã–π—Ç–∏
\q
```

### –†–∞–±–æ—Ç–∞ —Å —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –ë–î:
```powershell
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É –∏ –ë–î
ssh root@81.90.31.129
sudo -u postgres psql -d shar_messenger

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å
ssh root@81.90.31.129 "sudo -u postgres psql -d shar_messenger -c 'SELECT COUNT(*) FROM users;'"
```

### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ:
```powershell
# –õ–æ–∫–∞–ª—å–Ω—ã–π –±—ç–∫–∞–ø
pg_dump -h localhost -U postgres shar_messenger > backup_$(Get-Date -Format 'yyyyMMdd').sql

# –°–µ—Ä–≤–µ—Ä–Ω—ã–π –±—ç–∫–∞–ø
ssh root@81.90.31.129 "sudo -u postgres pg_dump shar_messenger > /var/backups/shar_messenger_$(date +%Y%m%d).sql"
```

## üîÑ –û—Ç–∫–∞—Ç –∫ JSON (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

–ï—Å–ª–∏ –ø–æ –∫–∞–∫–æ–π-—Ç–æ –ø—Ä–∏—á–∏–Ω–µ –Ω—É–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ JSON:

1. –í —Ñ–∞–π–ª–µ `backend/.env` –∏–∑–º–µ–Ω–∏—Ç—å:
   ```env
   USE_POSTGRES=false
   ```

2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

3. JSON —Ñ–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –∫–∞–∫ `.backup`

**–ù–û –õ–£–ß–®–ï –ù–ï –í–û–ó–í–†–ê–©–ê–¢–¨–°–Ø! PostgreSQL –Ω–∞–º–Ω–æ–≥–æ –Ω–∞–¥–µ–∂–Ω–µ–µ.**

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –†–∞–∑–º–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
```sql
SELECT pg_size_pretty(pg_database_size('shar_messenger'));
```

### –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π:
```sql
SELECT 
    'users' as table, COUNT(*) FROM users
UNION ALL SELECT 'tasks', COUNT(*) FROM tasks
UNION ALL SELECT 'events', COUNT(*) FROM events
UNION ALL SELECT 'links', COUNT(*) FROM links
UNION ALL SELECT 'products', COUNT(*) FROM products;
```

### –ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:
```sql
SELECT name, last_seen 
FROM users 
WHERE is_online = true 
ORDER BY last_seen DESC;
```

## üéâ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ PostgreSQL

1. **–¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö** - –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–ª—É—á–∞–π–Ω–æ –ø–æ–≤—Ä–µ–¥–∏—Ç—å —Ñ–∞–π–ª
2. **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏** - –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞—Ç–æ–º–∞—Ä–Ω—ã
3. **–ò–Ω–¥–µ–∫—Å—ã** - –±—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –ø–æ –ª—é–±—ã–º –ø–æ–ª—è–º
4. **–°–≤—è–∑–∏** - –≤–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å
5. **–†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã
6. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –º–∏–ª–ª–∏–æ–Ω—ã –∑–∞–ø–∏—Å–µ–π –±–µ–∑ –ø—Ä–æ–±–ª–µ–º
7. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î
8. **–†–µ–ø–ª–∏–∫–∞—Ü–∏—è** - –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å master-slave

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î: `python test_postgres.py`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `.env` —Ñ–∞–π–ª
4. JSON –±—ç–∫–∞–ø—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã - –≤—Å–µ–≥–¥–∞ –º–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–í–ê–ñ–ù–û**: –ò–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ –≤ production!

–í —Ñ–∞–π–ª–∞—Ö:
- `backend/.env` (–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)
- `deploy-postgres.ps1`
- `sync-postgres.ps1`

–ó–∞–º–µ–Ω–∏—Ç–µ `Traplord999!` –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–∞—Ä–æ–ª—å.

---

**–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ–¥–∏–Ω–∞—è, –Ω–∞–¥–µ–∂–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—Å–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è! üéä**
